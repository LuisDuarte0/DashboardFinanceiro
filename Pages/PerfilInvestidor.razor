@page "/perfilinvestidor"

<div class="container-perfil">
    <h2 class="titulo-perfil">üë§ Descubra seu Perfil de Investidor</h2>

    @if (!iniciouTeste)
    {
        <div class="intro">
            <p class="descricao-teste">
                Este teste ajudar√° voc√™ a entender qual o seu perfil de investidor. Responda as perguntas abaixo 
                e descubra se voc√™ √© um investidor Conservador, Moderado ou Agressivo.
            </p>
            <button class="btn-iniciar" @onclick="IniciarTeste">üöÄ Iniciar Teste</button>
        </div>
    }
    else if (etapa < perguntas.Count)
    {
        <div class="card-pergunta">
            <h3 class="pergunta">@perguntas[etapa].Texto</h3>

            <div class="opcoes-container">
                @foreach (var opcao in perguntas[etapa].Opcoes)
                {
                    <button class="btn-opcao" @onclick="() => SelecionarOpcao(opcao.Pontos)">
                        @opcao.Texto
                    </button>
                }
            </div>
        </div>
    }
    else
    {
        <div class="resultado-final">
            <h2 class="titulo-resultado">üéØ Seu Perfil de Investidor:</h2>
            <p class="perfil-texto">@perfilInvestidor</p>
            <button class="btn-reiniciar" @onclick="ReiniciarQuestionario">üîÑ Refazer Teste</button>
        </div>
    }
</div>

@code {
    private bool iniciouTeste = false;
    private int etapa = 0;
    private int pontuacaoTotal = 0;
    private string perfilInvestidor = "";

    private List<Pergunta> perguntas = new()
    {
        new Pergunta("1Ô∏è‚É£ Qual o seu objetivo ao investir?", new List<Opcao> {
            new Opcao("Preservar meu dinheiro", 1),
            new Opcao("Rentabilidade est√°vel", 2),
            new Opcao("Lucro alto, aceito riscos", 3)
        }),
        new Pergunta("2Ô∏è‚É£ Quanto tempo pretende manter o investimento?", new List<Opcao> {
            new Opcao("Menos de 1 ano", 1),
            new Opcao("1 a 5 anos", 2),
            new Opcao("Mais de 5 anos", 3)
        }),
        new Pergunta("3Ô∏è‚É£ Como se sentiria se seu investimento ca√≠sse 10% em um m√™s?", new List<Opcao> {
            new Opcao("Venderia tudo", 1),
            new Opcao("Esperaria recuperar", 2),
            new Opcao("Compraria mais", 3)
        }),
        new Pergunta("4Ô∏è‚É£ Qual sua experi√™ncia com investimentos?", new List<Opcao> {
            new Opcao("Nenhuma", 1),
            new Opcao("Alguma experi√™ncia", 2),
            new Opcao("Muita experi√™ncia", 3)
        }),
        new Pergunta("5Ô∏è‚É£ Voc√™ tem reserva de emerg√™ncia?", new List<Opcao> {
            new Opcao("N√£o", 1),
            new Opcao("Parcialmente", 2),
            new Opcao("Sim, totalmente", 3)
        }),
        new Pergunta("6Ô∏è‚É£ Como lida com oscila√ß√µes do mercado?", new List<Opcao> {
            new Opcao("Evito riscos", 1),
            new Opcao("Aceito moderadamente", 2),
            new Opcao("N√£o me preocupo", 3)
        }),
        new Pergunta("7Ô∏è‚É£ Voc√™ investiria em ativos de alto risco?", new List<Opcao> {
            new Opcao("Nunca", 1),
            new Opcao("Talvez", 2),
            new Opcao("Sim", 3)
        }),
        new Pergunta("8Ô∏è‚É£ Caso um investimento desvalorize 20% em um m√™s, o que faria?", new List<Opcao> {
            new Opcao("Venderia tudo", 1),
            new Opcao("Esperaria recuperar", 2),
            new Opcao("Compraria mais", 3)
        }),
        new Pergunta("9Ô∏è‚É£ Qual sua idade?", new List<Opcao> {
            new Opcao("Acima de 60 anos", 1),
            new Opcao("Entre 30 e 60 anos", 2),
            new Opcao("Menos de 30 anos", 3)
        }),
        new Pergunta("üîü Qual percentual de sua renda mensal pode investir?", new List<Opcao> {
            new Opcao("Menos de 10%", 1),
            new Opcao("10% a 30%", 2),
            new Opcao("Acima de 30%", 3)
        }),
    };

    private void IniciarTeste()
    {
        iniciouTeste = true;
    }

    private void SelecionarOpcao(int pontos)
    {
        pontuacaoTotal += pontos;
        etapa++;

        if (etapa == perguntas.Count)
        {
            if (pontuacaoTotal <= 10) perfilInvestidor = "üõ°Ô∏è Conservador: Prioriza seguran√ßa e evita riscos.";
            else if (pontuacaoTotal <= 20) perfilInvestidor = "‚öñÔ∏è Moderado: Busca equil√≠brio entre risco e seguran√ßa.";
            else perfilInvestidor = "üöÄ Agressivo: Tolera riscos para buscar maior rentabilidade.";
        }
    }

    private void ReiniciarQuestionario()
    {
        iniciouTeste = false;
        etapa = 0;
        pontuacaoTotal = 0;
        perfilInvestidor = "";
    }

    private class Pergunta
    {
        public string Texto { get; }
        public List<Opcao> Opcoes { get; }

        public Pergunta(string texto, List<Opcao> opcoes)
        {
            Texto = texto;
            Opcoes = opcoes;
        }
    }

    private class Opcao
    {
        public string Texto { get; }
        public int Pontos { get; }

        public Opcao(string texto, int pontos)
        {
            Texto = texto;
            Pontos = pontos;
        }
    }
}
